const AppPoints = [{
    "Point": "HH400",
    "N": "30°46'19.9",
    "E": "114°11'47.0"
},
{
    "Point": "HH401",
    "N": "30°39'42.4",
    "E": "114°05'01.3"
},
{
    "Point": "HH402",
    "N": "30°33'36.9",
    "E": "113°58'49.4"
},
{
    "Point": "HH403",
    "N": "30°37'23.2",
    "E": "113°53'51.7"
},
{
    "Point": "HH404",
    "N": "30°50'41.3",
    "E": "114°07'24.3"
},
{
    "Point": "HH405",
    "N": "31°09'28.9",
    "E": "114°26'41.0"
},
{
    "Point": "HH406",
    "N": "30°48'04.1",
    "E": "114°36'04.0"
},
{
    "Point": "HH407",
    "N": "30°33'42.2",
    "E": "115°02'24.2"
},
{
    "Point": "HH410",
    "N": "30°22'53.3",
    "E": "113°47'57.0"
},
{
    "Point": "HH411",
    "N": "30°36'31.3",
    "E": "114°03'31.1"
},
{
    "Point": "HH412",
    "N": "30°32'52.2",
    "E": "113°59'48.0"
},
{
    "Point": "HH413",
    "N": "30°29'10.7",
    "E": "114°04'38.3"
},
{
    "Point": "HH414",
    "N": "30°42'27.3",
    "E": "114°18'12.0"
},
{
    "Point": "HH415",
    "N": "30°28'48.7",
    "E": "113°55'40.5"
},
{
    "Point": "HH416",
    "N": "30°24'45.1",
    "E": "113°51'33.3"
},
{
    "Point": "HH417",
    "N": "30°20'41.3",
    "E": "113°47'26.4"
},
{
    "Point": "HH418",
    "N": "30°58'58.1",
    "E": "114°15'52.7"
},
{
    "Point": "HH420",
    "N": "30°28'29.9",
    "E": "113°38'11.4"
},
{
    "Point": "HH421",
    "N": "30°31'27.8",
    "E": "113°43'24.5"
},
{
    "Point": "HH422",
    "N": "30°34'25.6",
    "E": "113°48'37.9"
},
{
    "Point": "HH423",
    "N": "30°32'18",
    "E": "114°07'50"
},
{
    "Point": "HH424",
    "N": "30°40'31",
    "E": "113°57'03"
},
{
    "Point": "HH425",
    "N": "30°36'00",
    "E": "114°02'59"
},
{
    "Point": "HH428",
    "N": "30°29'33.2",
    "E": "113°54'42.0"
},
{
    "Point": "HH429",
    "N": "30°25'29.5",
    "E": "113°50'35.0"
},
{
    "Point": "HH430",
    "N": "30°43'11.2",
    "E": "114°08'34.4"
},
{
    "Point": "HH450",
    "N": "30°45'27.5",
    "E": "114°12'38.7"
},
{
    "Point": "HH451",
    "N": "31°06'24.4",
    "E": "114°32'23.6"
},
{
    "Point": "HH452",
    "N": "31°06'29.6",
    "E": "114°34'16.4"
},
{
    "Point": "HH453",
    "N": "31°08'28.2",
    "E": "114°34'31.4"
},
{
    "Point": "HH454",
    "N": "30°58'43.7",
    "E": "114°07'15.9"
},
{
    "Point": "HH455",
    "N": "30°45'22.9",
    "E": "113°53'39.5"
},
{
    "Point": "HH456",
    "N": "31°02'46.8",
    "E": "114°11'24.7"
},
{
    "Point": "HH457",
    "N": "30°44'11.3",
    "E": "114°27'33.1"
},
{
    "Point": "HH458",
    "N": "30°35'15.1",
    "E": "114°18'23.2"
},
{
    "Point": "HH459",
    "N": "30°29'38.3",
    "E": "114°24'41.7"
},
{
    "Point": "HH460",
    "N": "30°55'25.0",
    "E": "114°21'05.2"
},
{
    "Point": "HH461",
    "N": "30°27'24.7",
    "E": "114°58'20.6"
},
{
    "Point": "HH462",
    "N": "31°21'38.2",
    "E": "114°36'11.4"
},
{
    "Point": "HH463",
    "N": "30°41'13.2",
    "E": "113°49'26.0"
},
{
    "Point": "HH464",
    "N": "30°54'39.5",
    "E": "114°22'04.7"
},
{
    "Point": "HH465",
    "N": "30°52'13.9",
    "E": "114°15'47.9"
},
{
    "Point": "HH466",
    "N": "30°50'08.4",
    "E": "114°19'46.7"
},
{
    "Point": "HH480",
    "N": "30°42'19.3",
    "E": "114°09'26.2"
},
{
    "Point": "HH500",
    "N": "30°46'55.1",
    "E": "114°14'08.4"
},
{
    "Point": "HH501",
    "N": "30°53'31.7",
    "E": "114°20'55.1"
},
{
    "Point": "HH502",
    "N": "30°59'53.7",
    "E": "114°27'28.0"
},
{
    "Point": "HH503",
    "N": "30°56'11.2",
    "E": "114°32'18.8"
},
{
    "Point": "HH504",
    "N": "30°38'03.7",
    "E": "114°13'42.2"
},
{
    "Point": "HH505",
    "N": "30°26'24.1",
    "E": "114°01'48.8"
},
{
    "Point": "HH507",
    "N": "31°03'04.8",
    "E": "114°30'45.0"
},
{
    "Point": "HH508",
    "N": "31°04'42.1",
    "E": "114°30'38.2"
},
{
    "Point": "HH511",
    "N": "30°56'36.4",
    "E": "114°22'18.5"
},
{
    "Point": "HH512",
    "N": "31°00'39.3",
    "E": "114°26'28.2"
},
{
    "Point": "HH513",
    "N": "31°04'26.7",
    "E": "114°21'30.0"
},
{
    "Point": "HH514",
    "N": "30°36'18.5",
    "E": "114°26'13.3"
},
{
    "Point": "HH515",
    "N": "30°29'34.1",
    "E": "114°59'35.5"
},
{
    "Point": "HH516",
    "N": "30°37'47.5",
    "E": "115°08'11.1"
},
{
    "Point": "HH517",
    "N": "31°05'12.0",
    "E": "114°49'24.0"
},
{
    "Point": "HH518",
    "N": "30°26'03.6",
    "E": "113°32'24.5"
},
{
    "Point": "HH519",
    "N": "30°12'40.2",
    "E": "113°47'53.3"
},
{
    "Point": "HH521",
    "N": "31°14'17.9",
    "E": "114°29'57.7"
},
{
    "Point": "HH522",
    "N": "31°02'50.8",
    "E": "114°28'43.6"
},
{
    "Point": "HH530",
    "N": "30°51'36.0",
    "E": "114°18'56.5"
},
{
    "Point": "HH550",
    "N": "30°47'42.7",
    "E": "114°13'11.6"
},
{
    "Point": "HH552",
    "N": "30°56'09.0",
    "E": "114°39'52.7"
},
{
    "Point": "HH553",
    "N": "30°30'21.2",
    "E": "114°13'22.7"
},
{
    "Point": "HH554",
    "N": "30°38'02.3",
    "E": "114°03'19.3"
},
{
    "Point": "HH556",
    "N": "30°50'08.1",
    "E": "113°58'29.7"
},
{
    "Point": "hH558",
    "N": "30°12'48.4",
    "E": "113°39'28.7"
},
{
    "Point": "HH559",
    "N": "30°14'20.1",
    "E": "113°39'19.0"
},
{
    "Point": "HH560",
    "N": "30°37'17.5",
    "E": "114°04'18.2"
},
{
    "Point": "HH561",
    "N": "31°22'52.6",
    "E": "114°42'04.3"
},
{
    "Point": "HH563",
    "N": "30°43'37.5",
    "E": "114°07'03.8"
},
{
    "Point": "HH580",
    "N": "30°52'21.7",
    "E": "114°17'57.1"
},
{
    "Point": "DCD",
    "N": "30°26.5'",
    "E": "114°09.4'"
},
{
    "Point": "DHB",
    "N": "30°41.8'",
    "E": "113°58.4'"
},
{
    "Point": "DHP",
    "N": "30°52.3'",
    "E": "114°28.3'"
},
{
    "Point": "HOK",
    "N": "31°19.4'  ",
    "E": "114°25.7'"
},
{
    "Point": "LKO",
    "N": "29°54.5'",
    "E": "113°41.4'"
},
{
    "Point": "WTM",
    "N": "30°38.4'",
    "E": "113°08.5'"
},
{
    "Point": "XSH",
    "N": "30°26.2'",
    "E": "115°16.1'"
},
{
    "Point": "BIVIP",
    "N": "31°07.7'",
    "E": "115°16.8'"
},
{
    "Point": "GUGAM",
    "N": "30°13.0'",
    "E": "113°11.1'"
},
{
    "Point": "ONIXO",
    "N": "31°46.7'",
    "E": "114°23.7'"
},
{
    "Point": "UBGIV",
    "N": "31°41.8'",
    "E": "114°30.1'"
}
];
const AppPointsInDecimal = [
{"Point":"HH400","coordinates":[114.19638888888889,30.772194444444445]},
{"Point":"HH401","coordinates":[114.08369444444443,30.661777777777775]},
{"Point":"HH402","coordinates":[113.9803888888889,30.56025]},
{"Point":"HH403","coordinates":[113.89769444444445,30.62311111111111]},
{"Point":"HH404","coordinates":[114.12341666666666,30.844805555555553]},
{"Point":"HH405","coordinates":[114.44472222222223,31.158027777777775]},
{"Point":"HH406","coordinates":[114.60111111111111,30.80113888888889]},
{"Point":"HH407","coordinates":[115.04005555555555,30.561722222222222]},
{"Point":"HH410","coordinates":[113.79916666666666,30.38147222222222]},
{"Point":"HH411","coordinates":[114.05863888888888,30.608694444444446]},
{"Point":"HH412","coordinates":[113.99666666666667,30.547833333333337]},
{"Point":"HH413","coordinates":[114.07730555555555,30.486305555555557]},
{"Point":"HH414","coordinates":[114.30333333333333,30.707583333333332]},
{"Point":"HH415","coordinates":[113.92791666666668,30.480194444444443]},
{"Point":"HH416","coordinates":[113.85924999999999,30.412527777777775]},
{"Point":"HH417","coordinates":[113.79066666666667,30.344805555555553]},
{"Point":"HH418","coordinates":[114.26463888888888,30.982805555555554]},
{"Point":"HH420","coordinates":[113.63650000000001,30.47497222222222]},
{"Point":"HH421","coordinates":[113.72347222222223,30.52438888888889]},
{"Point":"HH422","coordinates":[113.81052777777778,30.573777777777778]},
{"Point":"HH423","coordinates":[114.13055555555555,30.538333333333334]},
{"Point":"HH424","coordinates":[113.95083333333334,30.67527777777778]},
{"Point":"HH425","coordinates":[114.04972222222221,30.6]},
{"Point":"HH428","coordinates":[113.91166666666668,30.492555555555555]},
{"Point":"HH429","coordinates":[113.84305555555555,30.424861111111113]},
{"Point":"HH430","coordinates":[114.14288888888889,30.719777777777775]},
{"Point":"HH450","coordinates":[114.21075,30.757638888888888]},
{"Point":"HH451","coordinates":[114.53988888888888,31.10677777777778]},
{"Point":"HH452","coordinates":[114.57122222222222,31.108222222222224]},
{"Point":"HH453","coordinates":[114.57538888888888,31.141166666666667]},
{"Point":"HH454","coordinates":[114.12108333333333,30.978805555555553]},
{"Point":"HH455","coordinates":[113.89430555555556,30.75636111111111]},
{"Point":"HH456","coordinates":[114.19019444444444,31.046333333333337]},
{"Point":"HH457","coordinates":[114.45919444444445,30.736472222222222]},
{"Point":"HH458","coordinates":[114.30644444444444,30.587527777777776]},
{"Point":"HH459","coordinates":[114.41158333333334,30.493972222222222]},
{"Point":"HH460","coordinates":[114.35144444444444,30.92361111111111]},
{"Point":"HH461","coordinates":[114.97238888888889,30.45686111111111]},
{"Point":"HH462","coordinates":[114.60316666666667,31.360611111111112]},
{"Point":"HH463","coordinates":[113.82388888888889,30.687]},
{"Point":"HH464","coordinates":[114.36797222222222,30.91097222222222]},
{"Point":"HH465","coordinates":[114.26330555555556,30.870527777777777]},
{"Point":"HH466","coordinates":[114.32963888888888,30.835666666666665]},
{"Point":"HH480","coordinates":[114.15727777777778,30.70536111111111]},
{"Point":"HH500","coordinates":[114.23566666666667,30.781972222222223]},
{"Point":"HH501","coordinates":[114.34863888888889,30.892138888888887]},
{"Point":"HH502","coordinates":[114.45777777777778,30.998250000000002]},
{"Point":"HH503","coordinates":[114.53855555555555,30.936444444444444]},
{"Point":"HH504","coordinates":[114.22838888888889,30.63436111111111]},
{"Point":"HH505","coordinates":[114.03022222222222,30.44002777777778]},
{"Point":"HH507","coordinates":[114.5125,31.051333333333336]},
{"Point":"HH508","coordinates":[114.51061111111112,31.07836111111111]},
{"Point":"HH511","coordinates":[114.37180555555555,30.943444444444445]},
{"Point":"HH512","coordinates":[114.44116666666667,31.010916666666667]},
{"Point":"HH513","coordinates":[114.35833333333333,31.074083333333334]},
{"Point":"HH514","coordinates":[114.43702777777779,30.60513888888889]},
{"Point":"HH515","coordinates":[114.99319444444444,30.492805555555556]},
{"Point":"HH516","coordinates":[115.13641666666668,30.62986111111111]},
{"Point":"HH517","coordinates":[114.82333333333332,31.086666666666666]},
{"Point":"HH518","coordinates":[113.54013888888889,30.434333333333335]},
{"Point":"HH519","coordinates":[113.79813888888889,30.211166666666667]},
{"Point":"HH521","coordinates":[114.49936111111111,31.238305555555556]},
{"Point":"HH522","coordinates":[114.47877777777778,31.047444444444444]},
{"Point":"HH530","coordinates":[114.31569444444445,30.860000000000003]},
{"Point":"HH550","coordinates":[114.21988888888889,30.795194444444448]},
{"Point":"HH552","coordinates":[114.66463888888889,30.935833333333335]},
{"Point":"HH553","coordinates":[114.22297222222223,30.50588888888889]},
{"Point":"HH554","coordinates":[114.05536111111111,30.633972222222223]},
{"Point":"HH556","coordinates":[113.97491666666667,30.835583333333332]},
{"Point":"hH558","coordinates":[113.65797222222223,30.213444444444445]},
{"Point":"HH559","coordinates":[113.65527777777778,30.238916666666668]},
{"Point":"HH560","coordinates":[114.07172222222222,30.62152777777778]},
{"Point":"HH561","coordinates":[114.70119444444445,31.38127777777778]},
{"Point":"HH563","coordinates":[114.11772222222221,30.727083333333333]},
{"Point":"HH580","coordinates":[114.29919444444444,30.872694444444445]},
{"Point":"DCD","coordinates":[114.15666666666667,30.441666666666666]},
{"Point":"DHB","coordinates":[113.97333333333333,30.696666666666665]},
{"Point":"DHP","coordinates":[114.47166666666666,30.871666666666666]},
{"Point":"HOK","coordinates":[114.42833333333333,31.323333333333334]},
{"Point":"LKO","coordinates":[113.69,29.908333333333335]},
{"Point":"WTM","coordinates":[113.14166666666667,30.64]},
{"Point":"XSH","coordinates":[115.26833333333333,30.436666666666667]},
{"Point":"BIVIP","coordinates":[115.28,31.128333333333334]},
{"Point":"GUGAM","coordinates":[113.185,30.216666666666665]},
{"Point":"ONIXO","coordinates":[114.395,31.778333333333332]},
{"Point":"UBGIV","coordinates":[114.50166666666667,31.696666666666665]},
];
const AppRNPAirways = [
{
    "PROCEDURE": "ONIXO-08A",
    "POINTS": [
        "ONIXO",
        "HH405",
        "DHP",
        "HH414",
        "HH413",
    ]
},
{
    "PROCEDURE": "ONIXO-09A",
    "POINTS": [
        "ONIXO",
        "HH405",
        "HH418",
        "HH404",
        "HH403",
    ]
},
{
    "PROCEDURE": "XSH-08A",
    "POINTS": [
        "XSH",
        "HH407",
        "HH406",
        "DHP",
        "HH418",
        "HH404",
        "HH403"
    ]
},
{
    "PROCEDURE": "XSH-09A",
    "POINTS": [
        "XSH",
        "HH407",
        "HH406",
        "DHP",
        "HH414",
        "HH413",
    ]
},
{
    "PROCEDURE": "GUGAM-09A",
    "POINTS": [
        "GUGAM",
        "HH420",
        "HH421",
        "HH422",
        "HH403",
        "HH414",
        "HH413",
    ]
},
{
    "PROCEDURE": "LKO-09A",
    "POINTS": [
        "LKO",
        "HH417",
    ]
},
{
    "PROCEDURE": "ONIXO-19A",
    "POINTS": [
        "ONIXO",
        "HOK",
        "HH521"
    ]
},
{
    "PROCEDURE": "XSH-18A",
    "POINTS": [
        "XSH",
        "HH516",
        "HH517"
    ]
},
{
    "PROCEDURE": "XSH-19A",
    "POINTS": [
        "XSH",
        "HH515",
        "HH514",
        "HH414",
        "HH503"
    ]
},
{
    "PROCEDURE": "XSH-17A",
    "POINTS": [
        "XSH",
        "HH461",
        "HH459",
        "HH504",
        "HH414",
        "HH503"
    ]
},
{
    "PROCEDURE": "LKO-18A",
    "POINTS": [
        "LKO",
        "HH519",
        "HH505",
        "HH504",
        "HH414",
        "HH503"

    ]
},
{
    "PROCEDURE": "LKO-19A",
    "POINTS": [
        "LKO",
        "HH519",
        "DHB",
        "HH404",
        "HH513",
    ]
},
{
    "PROCEDURE": "GUGMA-18A",
    "POINTS": [
        "GUGAM",
        "HH518",
        "HH505",
        "HH504",
        "HH414",
        "HH503"
    ]
},
{
    "PROCEDURE": "GUGMA-18A",
    "POINTS": [
        "GUGAM",
        "HH518",
        "DHB",
        "HH404",
        "HH513",
    ]
}
];

function outputAirwaysInGeojsonLineString(params) {
var _tempAllRNPAirwaysInGeoJsonFormate = {
    "type": "FeatureCollection",
    "features": [{
            "type": "Feature",
            "properties": {},
            "geometry": {
                "type": "LineString",
                "coordinates": []
            }
        },
        {
            "type": "Feature",
            "properties": {},
            "geometry": {
                "type": "LineString",
                "coordinates": []
            }
        }
    ]
};


var _output;
for (let x = 0; x < AppRNPAirways.length; x++) {
    var _temp = {
        "type": "FeatureCollection",
        "features": []
    };
    var _inner=
        {
            "type": "Feature",
            "properties": {},
            "geometry": {
                "type": "LineString",
                "coordinates": []
            }
        }    
    ;

    _inner.properties=AppRNPAirways[x];
    var _codi=new Array();
     
    for (let j = 0; j < AppRNPAirways[x].POINTS.length; j++) {
        const e = AppRNPAirways[x].POINTS[j];
        for (let u = 0; u < AppPointsInDecimal.length; u++) {
           if (AppPointsInDecimal[u].Point===e) {
            // console.log(j+"::"+"  "+JSON.stringify( AppPointsInD[u]));
            _codi.push(AppPointsInDecimal[u].coordinates);
           }
            
        };
    };
    // console.log(_codi);
    _inner.geometry.coordinates=_codi;
    // console.log(JSON.stringify( _inner));
    _temp.features.push(_inner);

    // console.log(JSON.stringify(_temp)+','); 

    //
   

    const fs=require('fs');
    var path=require('path');
    var filename='ZHHH'+ AppRNPAirways[x].PROCEDURE.replace('-','').toUpperCase();
    var _p=path.join(__dirname,filename);
    fs.writeFile(_p+'.geojson', JSON.stringify(_temp), err => {
        if (err) {
            console.error(err);
            return;
        }
    })

    //
};
};




function formateToXdotXXXX(items) {
var points="{"+
    "\"type\": \"FeatureCollection\","+
    "\"features\": \[";

items.forEach(i => {

    var NN = i.N.split("°")[0];
    NN = NN / 1;
    var mm = i.N.split("°")[1].split("'")[0];
    mm = mm / 60;
    var ss = i.N.split("°")[1].split("'")[1];
    ss = ss / 3600;

    NN = NN + mm + ss;

    var EE = i.E.split("°")[0];
    EE = EE / 1;
    var _mm = i.E.split("°")[1].split("'")[0];
    _mm = _mm / 60;
    var _ss = i.E.split("°")[1].split("'")[1];
    _ss = _ss / 3600;
    EE = EE + _mm + _ss;

    var point = {
        type: "Feature",
        properties: {
            title: ""
        },
        geometry: {
            type: "Point",
            coordinates: [
                0,
                0
            ]
        }
    };

    var pointInDecimal = {
        Point: "",
        coordinates: [],
    };

    pointInDecimal.Point = i.Point;
    pointInDecimal.coordinates = [EE, NN];
    // console.log(JSON.stringify(pointInDecimal) + ',');


    point.properties.title = i.Point;
    point.geometry.coordinates = [EE, NN];
    // console.log(' '+dd+' '+mm+' '+ss);
    console.log(JSON.stringify(point) + ',');
    points=points+JSON.stringify(point) + ',';
    

});
const _l=points.length;
points=points.substr(0,_l-1)+"]\}";

const fs=require('fs');
var path=require('path');
var _p=path.join(__dirname,'ZHHH_App_RNP_Fix')
fs.writeFile(_p+'.geojson', points, err => {
    if (err) {
        console.error(err);
        return;
    }
})
};

// formateToXdotXXXX(AppPoints);
outputAirwaysInGeojsonLineString();



function calSum() {
var _x=[
    16351.37,
    16258.24,
    9020.00, 
    16539.55,
    15029.83,
    11477.36,
    14777.83,
    16407.03,
    15190.99,
    27738.79, 
    2000.00,  
    18722.59,
    15000.49,
    3150.00, 
    20225.59, 
    3043.80, 
    14726.38, 
];

var sum=0;
_x.forEach(i => {
    sum=sum+i
});
console.log('sum='+sum);

}

// calSum();


const mongoose = require("mongoose");
var DB_URL='mongodb://127.0.0.1:27017/testmongodb1';
mongoose.connect(DB_URL,{useNewUrlParser: true});

/**
* 连接成功
*/
mongoose.connection.on('connected', function () {    
console.log('Mongoose connection open to ' + DB_URL);  
});    

/**
* 连接异常
*/
mongoose.connection.on('error',function (err) {    
console.log('Mongoose connection error: ' + err);  
});    

/**
* 连接断开
*/
mongoose.connection.on('disconnected', function () {    
console.log('Mongoose connection disconnected');  
});    

const Schema = mongoose.Schema;
var schema = new Schema({
pointName: { type: String,trim:true, uppercase: true }, // HH413 LKO UBGIV
longitude: String, // 经度 longitude
latitude: String, // 纬度 latitude
madeBy: String, // VOR/DME GNSS-Point
type: String, // fly-over fly-by navigation ILS
logInfo: {type:[schema],default:[]} // every time this point is modified record the last Point
});

NavFix= mongoose.model("NavFix", schema);


function mongooseSave() {
    AppPoints.forEach(p => {
        var _navfix=new NavFix(
            {
                pointName:p.Point,
                longitude:p.E,
                latitude:p.N
            }
        )
        _navfix.save(function (err) {
            if (err) return console.log(err);
            // saved!
        }
        )
    });
}

mongooseSave();